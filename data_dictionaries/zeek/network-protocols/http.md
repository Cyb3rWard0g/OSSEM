# HTTP Log

## Description

## Data Dictionary

| Standard Name                   | Field Name           | Type         | Description                                                                                                                                                                                                                                                              | Sample Value                                                                                                                                                                                                                                           |
| ------------------------------- | -------------------- | ------------ | -------------------------------                                                                                                                                                                                                                                          | -------------------------------                                                                                                                                                                                                                        |
| @timestamp                      | ts                   | date_time    | Timestamp of the beginning of the event in epoch format                                                                                                                                                                                                                  | `1230820619`                                                                                                                                                                                                                                           |
| http_request_header_names       | client_header_names  | array_string | The vector of HTTP header names sent by the client. No header values are included here, just the header names. present if [policy/protocols/http/header-names.zeek](https://github.com/zeek/zeek/blob/master/scripts/policy/protocols/http/header-names.zeek) is loaded. | `["USER-AGENT", "ACCEPT", "ACCEPT-LANGUAGE", "ACCEPT-ENCODING", "ACCEPT-CHARSET", "KEEP-ALIVE", "CONNECTION", "DATE", "SERVER", "MICROSOFTOFFICEWEBSERVER", "X-POWERED-BY", "CONTENT-LENGTH", "CONTENT-TYPE", "SET-COOKIE", "CACHE-CONTROL"]`          |
| http_cookie_header_variables    | cookie_vars          | array_string | Variable names extracted from all cookies. present if [policy/protocols/http/var-extraction-cookies.zeek](https://github.com/zeek/zeek/blob/master/scripts/policy/protocols/http/var-extraction-cookies.zeek) is loaded.                                                 | `[ "nflx-rgn", "nfvdid", "memclid", "NetflixId" ]`
| software_flash_version_original | flash_version        | string       | The unparsed Flash version, if detected. present if [policy/protocols/http/software-browser-plugins.zeek](https://github.com/zeek/zeek/blob/master/scripts/policy/protocols/http/software-browser-plugins.zeek) is loaded.                                               | ``                                                                                                                                                                                                                                                     |
| http_request_header_host        | host                 | string       | Value of the HOST header                                                                                                                                                                                                                                                 | `www.activewebsoftwares.com`                                                                                                                                                                                                                           |
| src_ip_addr                     | id.orig_h            | ip           | The originating/source IP address                                                                                                                                                                                                                                        | `117.195.143.198`                                                                                                                                                                                                                                      |
| src_port                        | id.orig_p            | integer      | The originating/source port                                                                                                                                                                                                                                              | `2308`                                                                                                                                                                                                                                                 |
| dst_ip_addr                     | id.resp_h            | ip           | The responding/destination IP address                                                                                                                                                                                                                                    | `208.106.128.136`                                                                                                                                                                                                                                      |
| dst_port                        | id.resp_p            | integer      | The responding/destination port                                                                                                                                                                                                                                          | `80`                                                                                                                                                                                                                                                   |
| http_informational_code         | info_code            | integer      | Last seen 1xx informational reply code returned by the server.                                                                                                                                                                                                           | ``                                                                                                                                                                                                                                                     |
| http_informational_message      | info_msg             | string       | Last seen 1xx informational reply message returned by the server.                                                                                                                                                                                                        | ``                                                                                                                                                                                                                                                     |
| http_request_method             | method               | string       | Verb used in the HTTP request (GET, POST, HEAD, etc.).                                                                                                                                                                                                                   | `GET`                                                                                                                                                                                                                                                  |
| zeek_http_omniture              | omniture             | boolean      | present if [policy/protocols/http/software-browser-plugins.zeek](https://github.com/zeek/zeek/blob/master/scripts/policy/protocols/http/software-browser-plugins.zeek) is loaded Indicates if the server is an omniture advertising server.                              | ``                                                                                                                                                                                                                                                     |
| src_file_name                   | orig_filenames       | string       | An ordered vector of filenames from the client. present if base/protocols/http/entities.zeek is loaded.                                                                                                                                                                  | ``                                                                                                                                                                                                                                                     |
| zeek_id_orig_fuids              | orig_fuids           | array_string | An ordered vector of file unique IDs. present if base/protocols/http/entities.zeek is loaded.                                                                                                                                                                            | ``                                                                                                                                                                                                                                                     |
| src_mime_type                   | orig_mime_types      | array_string | An ordered vector of mime types. present if base/protocols/http/entities.zeek is loaded.                                                                                                                                                                                 | `["text/html"]`                                                                                                                                                                                                                                        |
| http_request_header_origin      | origin               | string       | Value of the Origin header from the client                                                                                                                                                                                                                               | ``                                                                                                                                                                                                                                                     |
| user_password                   | password             | string       | Password if basic-auth is performed for the request                                                                                                                                                                                                                      | `bobspassword`                                                                                                                                                                                                                                         |
| http_response_body_original     | post_body            | string       | Content from the source/client inside the HTTP request body.                                                                                                                                                                                                             | `{"pkg_utime":"0","conf_utime":"1555582468054"}`                                                                                                                                                                                                       |
| http_proxied_headers            | proxied              | array_string | All of the headers that may indicate if the request was proxied. example: `FORWARDED`;`X-FORWARDED-FOR`;`X-FORWARDED-FROM`;`CLIENT-IP`;`VIA`;`XROXY-CONNECTION`;`PROXY-CONNECTION`                                                                                       | ``                                                                                                                                                                                                                                                     |
| http_referrer_original          | referrer             | string       | Value of the "referer" header. The comment is deliberately misspelled like the standard declares, but the name used here is “referrer” spelled correctly                                                                                                                 | `http://localcontrol.netflix.com/js/boot.js`                                                                                                                                                                                                           |
| http_request_body_bytes         | request_body_len     | integer      | Actual uncompressed content size of the data transferred from the client                                                                                                                                                                                                 | `0`                                                                                                                                                                                                                                                    |
| file_name                       | resp_filenames       | array_string | present if base/protocols/http/entities.zeek is loaded An ordered vector of filenames from the server.                                                                                                                                                                   | `UserHistorySheetNew.xls`                                                                                                                                                                                                                              |
| zeek_id_resp_fuids              | resp_fuids           | array_string | present if base/protocols/http/entities.zeek is loaded An ordered vector of file unique IDs.                                                                                                                                                                             | `["FE7s2f1ljAxbVlbasi"]`                                                                                                                                                                                                                               |
| file_mime_type                  | resp_mime_types      | array_string | present if base/protocols/http/entities.zeek is loaded An ordered vector of mime types.                                                                                                                                                                                  | `["text/plain", "application/pdf" ]`                                                                                                                                                                                                                   |
| http_response_body_bytes        | response_body_len    | integer      | Actual uncompressed content size of the data transferred from the server                                                                                                                                                                                                 | `4951`                                                                                                                                                                                                                                                 |
| http_response_header_names      | server_header_names  | array_string | The vector of HTTP header names sent by the server. No header values are included here, just the header names. present if [policy/protocols/http/header-names.zeek](https://github.com/zeek/zeek/blob/master/scripts/policy/protocols/http/header-names.zeek) is loaded. | ` ["HOST", "USER-AGENT", "ACCEPT", "ACCEPT-LANGUAGE", "ACCEPT-ENCODING", "ACCEPT-CHARSET", "KEEP-ALIVE", "CONNECTION", "DATE", "SERVER", "MICROSOFTOFFICEWEBSERVER", "X-POWERED-BY", "CONTENT-LENGTH", "CONTENT-TYPE", "SET-COOKIE", "CACHE-CONTROL"]` |
| http_status_code                | status_code          | integer      | Status code returned by the server                                                                                                                                                                                                                                       | `500`                                                                                                                                                                                                                                                  |
| http_status_message             | status_msg           | string       | Status message returned by the server                                                                                                                                                                                                                                    | `Internal Server Error`                                                                                                                                                                                                                                |
| zeek_http_tags                  | tags                 | array_string | A set of indicators of various attributes discovered and related to a particular request/response pair                                                                                                                                                                   | `["HTTP::URI_SQLI"]`                                                                                                                                                                                                                                   |
| zeek_http_trans_depth           | trans_depth          | integer      | Represents the pipelined depth into the connection of this request/response transaction                                                                                                                                                                                  | `1`                                                                                                                                                                                                                                                    |
| event_uid                       | uid                  | string       | Unique ID for the connection.                                                                                                                                                                                                                                            | `CZHkS53IZOwi2WQ1Sj`                                                                                                                                                                                                                                   |
| url_original                    | uri                  | string       | URI used in the request                                                                                                                                                                                                                                                  | `/demoactivebusinessdirectory/default.asp?catid=0+and+1=0`                                                                                                                                                                                             |
| url_query_values                | uri_vars             | array_string | present if [policy/protocols/http/var-extraction-uri.zeek](https://github.com/zeek/zeek/blob/master/scripts/policy/protocols/http/var-extraction-uri.zeek) is loaded Variable names from the URI.                                                                        | ``                                                                                                                                                                                                                                                     |
| user_agent_original             | user_agent           | string       | Value of the User-Agent header from the client                                                                                                                                                                                                                           | `Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.9.0.5) Gecko/2008120122 Firefox/3.0.5`                                                                                                                                                           |
| user_name                       | username             | string       | Username if basic-auth is performed for the request                                                                                                                                                                                                                      | `bobsyauncle`                                                                                                                                                                                                                                          |
| http_version                    | version              | string       | Value of the version portion of the request.                                                                                                                                                                                                                             | `1.2`                                                                                                                                                                                                                                                  |
| dst_host_name                   | z_Enrichment         | string       | Enrichment copied from `http_header_host`                                                                                                                                                                                                                                | ``                                                                                                                                                                                                                                                     |
| file_path                       | z_Enrichment         | string       | Enrichment copied from `file_name`                                                                                                                                                                                                                                       | ``                                                                                                                                                                                                                                                     |
| src_file_path                   | z_Enrichment         | string       | Enrichment copied from `src_file_name`                                                                                                                                                                                                                                   | ``                                                                                                                                                                                                                                                     |
| network_protocol                | z_Enrichment         | string       | Enrichment implied tcp.                                                                                                                                                                                                                                                  | `tcp`                                                                                            |

## Event JSON

```json
{
    "ts": 1230820619.37404,
    "uid": "CZHkS53IZOwi2WQ1Sj",
    "id.orig_h": "117.195.143.198",
    "id.orig_p": 2308,
    "id.resp_h": "208.106.128.136",
    "id.resp_p": 80,
    "trans_depth": 1,
    "method": "GET",
    "host": "www.activewebsoftwares.com",
    "uri": "/demoactivebusinessdirectory/default.asp?catid=0+and+1=0",
    "version": "1.1",
    "user_agent": "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.9.0.5) Gecko/2008120122 Firefox/3.0.5",
    "request_body_len": 0,
    "response_body_len": 4951,
    "status_code": 500,
    "status_msg": "Internal Server Error",
    "tags": [
        "HTTP::URI_SQLI"
    ],
    "resp_fuids": [
        "FE7s2f1ljAxbVlbasi"
    ],
    "resp_mime_types": [
        "text/html"
    ],
    "client_header_names": [
        "HOST",
        "USER-AGENT",
        "ACCEPT",
        "ACCEPT-LANGUAGE",
        "ACCEPT-ENCODING",
        "ACCEPT-CHARSET",
        "KEEP-ALIVE",
        "CONNECTION",
        "DATE",
        "SERVER",
        "MICROSOFTOFFICEWEBSERVER",
        "X-POWERED-BY",
        "CONTENT-LENGTH",
        "CONTENT-TYPE",
        "SET-COOKIE",
        "CACHE-CONTROL"
    ],
    "server_header_names": [
        "HOST",
        "USER-AGENT",
        "ACCEPT",
        "ACCEPT-LANGUAGE",
        "ACCEPT-ENCODING",
        "ACCEPT-CHARSET",
        "KEEP-ALIVE",
        "CONNECTION",
        "DATE",
        "SERVER",
        "MICROSOFTOFFICEWEBSERVER",
        "X-POWERED-BY",
        "CONTENT-LENGTH",
        "CONTENT-TYPE",
        "SET-COOKIE",
        "CACHE-CONTROL"
    ]
}
```
